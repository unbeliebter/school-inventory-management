<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<link th:href="@{/css/main.css}" type="text/css" rel="stylesheet">

<dialog id="itemDialog" closedBy="any">
    <form id="newItemForm" method="post" th:action="${Path} + '/add'" th:object="${newTableItem}">
        <input type="hidden" th:name="tableItemId" id="id-input" th:value="*{id}"/>
        <div class="dialog-main-container">
            <div>
                <h3>Add Equipment</h3>
            </div>
            <div class="label-with-input-horizontal">
                <label>Inventar Nr.:</label>
                <input th:field="*{inventoryNumber}" id="inventoryNumber-input" class="dialog-input" type="text" min="1" minlength="1"
                       maxlength="16" required>
            </div>
            <div class="label-with-input-horizontal">
                <label>Gegenstand:</label>
                <input th:field="*{equipmentName}" id="itemName-input" class="dialog-input" type="text" min="1" minlength="1"
                       required>
            </div>
            <div class="label-with-input-horizontal">
                <label>Abteilung:</label>
                <select th:field="*{organizationalUnit}" id="organizationalUnit-input" class="dialog-input">
                    <option th:each="unit : ${Units}" th:value="${unit.id}" th:text="${unit.name}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Gruppe:</label>
                <select th:field="*{organizationalGroup}" id="organizationalGroup-input" class="dialog-input">
                    <option th:each="group : ${Groups}" th:value="${group.id}" th:text="${group.name}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Fach:</label>
                <select th:field="*{subject}" id="subject-input" class="dialog-input">
                    <option th:each="subject : ${Subjects}" th:value="${subject.id}" th:text="${subject.name}">
                    </option>
                </select>
            </div>
            <label id="add-Item-Error" class="error" shown="false"></label>
            <div class="label-with-input-horizontal">
                <label>Ort:</label>
                <select th:field="*{position}" id="position-input" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="position : ${Positions}" th:value="${position.id}"
                            th:text="${position.school} + ' ' + ${position.room}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Verantwortlicher:</label>
                <select th:field="*{responsibleUser}" id="responsibleUser-input" class="dialog-input">
                    <option th:each="user : ${Users}" th:value="${user.id}"
                            th:text="${user.firstname} + ' ' + ${user.lastname}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Zustand:</label>
                <select th:field="*{equipmentState}" id="equipmentState-input" class="dialog-input">
                    <option th:each="state : ${States}" th:value="${state}" th:text="${state.name}">
                    </option>
                </select>
            </div>
            <div class="dialog-button-row">
                <button class="submit" type="button" onclick="validateOnAdd()">Submit</button>
                <button class="cancel" id="item-dialog-cancel-button" type="reset">Cancel</button>
            </div>
        </div>
    </form>
</dialog>

<dialog id="filterDialog" closedBy="any">
    <form method="POST" th:action="${Path} + '/filtered'" th:object="${newTableItem}">
        <div class="dialog-main-container">
            <div>
                <h3>Add Filter Option</h3>
            </div>
            <div class="label-with-input-horizontal">
                <label>Abteilung:</label>
                <select th:name="unit" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="unit : ${Units}" th:value="${unit.name}" th:text="${unit.name}"></option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Gruppe:</label>
                <select th:name="group" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="group : ${Groups}" th:value="${group.name}" th:text="${group.name}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Fach:</label>
                <select th:name="subject" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="subject : ${Subjects}" th:value="${subject.name}" th:text="${subject.name}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Verantwortlicher:</label>
                <select th:name="responsibleUser" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="user : ${Users}" th:value="${user.id}"
                            th:text="${user.firstname} + ' ' + ${user.lastname}">
                    </option>
                </select>
            </div>
            <div class="label-with-input-horizontal">
                <label>Zustand:</label>
                <select th:name="state" class="dialog-input">
                    <option selected="selected" th:value="null" th:text="null"></option>
                    <option th:each="state : ${States}" th:value="${state}" th:text="${state.name}">
                    </option>
                </select>
            </div>
            <div class="dialog-button-row">
                <button class="submit" type="submit">Submit</button>
                <button class="cancel" id="filter-dialog-cancel-button" type="reset">Cancel</button>
            </div>

        </div>

    </form>
</dialog>

<body>

<header th:replace="~{fragments.html :: header}"></header>

<section class="section-content">
    <nav th:replace="~{fragments.html :: sideBar}"></nav>

    <div class="container-content">
        <div th:replace="~{fragments.html :: table-control-header}"></div>

        <div class="container-inventory-table">
            <table>
                <caption class="table-inventory-caption">
                    Inventar
                </caption>
                <thead class="">
                <tr class="">
                    <th scope="col">Inventar Nr.</th>
                    <th scope="col">Gegenstand</th>
                    <th scope="col">Abteilung</th>
                    <th scope="col">Gruppe</th>
                    <th scope="col">Fach</th>
                    <th scope="col">Ort</th>
                    <th scope="col">Verantwortlicher</th>
                    <th scope="col">Zustand</th>
                    <th sec:authorize="hasAnyAuthority('ADMIN', 'RESPONSIBLE')" class="table-head-buttons" scope="col"></th>
                </tr>
                </thead>
                <tbody>
                <tr class="" th:each="item : ${TableItems}">
                    <td><span th:text="${item.inventoryNumber}">Nr</span></td>
                    <td><span th:text="${item.equipmentName}">Name</span></td>
                    <td><span th:text="${item.organizationalUnit.name}">Unit</span></td>
                    <td><span th:text="${item.organizationalGroup.name}">Group</span></td>
                    <td><span th:text="${item.subject.name}">Fach</span></td>
                    <td th:if="${item.position}">
                        <span th:text="${item.position.school}">Ort-Schule</span>
                        <br>
                        <span th:text="${item.position.room}">Ort-Raum</span>
                        <br>
                        <span th:text="${item.position.description}">Ort-Beschreibung</span>
                    </td>
                    <td th:unless="${item.position}"></td>
                    <td th:if="${item.responsibleUser}"><span
                            th:text="${item.responsibleUser.firstname} + ' ' + ${item.responsibleUser.lastname}">Zust√§ndig</span>
                    </td>
                    <td th:unless="${item.responsibleUser}"></td>
                    <td><span th:text="${item.equipmentState}">Status</span></td>
                    <td sec:authorize="hasAnyAuthority('ADMIN', 'RESPONSIBLE')" class="btn-cell">
                        <div class="container-table-buttons">
                            <button th:value="${item.id}" onclick="editTableItem(this.getAttribute('value'))" class="img-btn"><img th:src="@{/icons/edit.svg}" title="Edit Entry" alt="edit"></button>

                            <form th:action="${Path} + '/remove'" method="post">
                                <input type="hidden" th:name="tableItemId" th:value="${item.id}"/>
                                <button type="submit" class="img-btn"><img th:src="@{/icons/trash-2.svg}" title="Delete Entry" alt="delete"></button>
                            </form>
                        </div>

                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>




</body>
<script th:replace="~{fragments.html :: table-script}"></script>
<script type="text/javascript" th:src="@{/js/inventory.js}"></script>
<script type="text/javascript" th:src="@{/js/Dialogs/equipmentDialog.js}"></script>
</html>